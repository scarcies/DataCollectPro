modules = ["bash", "nodejs-20"]
compile = "make"

[nix]
channel = "stable-24_05"

[deployment]
build = ["sh", "-c", "make"]

[workflows]
runButton = "DataCollectPro Dev"

[[workflows.workflow]]
name = "DataCollectPro Dev"
author = 42083418
mode = "sequential"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"üöÄ Starting DataCollectPro Development Environment...\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "node server/lib/bin/run-migrations.js"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"üì¶ Installing server dependencies...\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "cd server && npm install"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"üì¶ Installing client dependencies...\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "cd ../client && npm install"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"üîß Starting development servers...\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"‚úÖ Development environment ready!\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "echo \"üåê Access at: http://0.0.0.0:5000\""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "cd ../server && npm run dev"
